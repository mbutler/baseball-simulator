function c0(q){let Q=/<!--([\s\S]*?)-->/g,J=[],U;while((U=Q.exec(q))!==null)J.push(U[1]);return J}function m0(q,Q){let J=new DOMParser;for(let U of q)if(U.includes(`id="${Q}"`))return J.parseFromString(U,"text/html").querySelector(`table#${Q}`);return null}function T0(q){let Q=document.createElement("div");Q.style.display="none",document.body.appendChild(Q),Q.innerHTML=q;let J=Q.querySelector("table#players_standard_batting"),U=Q.querySelector("table#players_standard_pitching"),X=c0(q),Z=m0(X,"players_standard_fielding");return Q.remove(),{batting:J,pitching:U,fielding:Z}}function F0(q){if(!q||!q.href)return null;let Q=q.href.match(/\/players\/.\/([^/.]+)\.shtml/);return Q?Q[1]:null}function l0(q){return q.toLowerCase().replace(/[^a-z0-9]/g,"").slice(0,12)}function j0(q){if(!q)return[];let Q=Array.from(q.querySelectorAll("tbody > tr")).filter((X)=>!X.classList.contains("thead")),J=Array.from(q.querySelectorAll("thead tr th")).map((X)=>(X.textContent??"").trim()),U=[];for(let X of Q){let Z=[X.querySelector("th"),...X.querySelectorAll("td")];if(Z.length!==J.length)continue;let V={};for(let Y=0;Y<J.length;Y++){let N=J[Y],z=Z[Y];if(Y===0){let j=z?.textContent?.trim()||"",E=z?.querySelector?.("a"),C=F0(E);if(/^\d+$/.test(j)){let M=X.querySelector("td");j=M?.textContent?.trim()||"(unknown)",E=M?.querySelector?.("a"),C=F0(E)||C}V.name=j,V.player_id=C||l0(j)}else{let j=z?.textContent?.trim()||"",E=Number(j.replace(/,/g,""));V[N]=isNaN(E)?j:E}}U.push(V)}return U}function k0(q){return q.map((Q)=>{let J=Number(Q.PA)||0,U=Number(Q.AB)||0,X=Number(Q.H)||0,Z=Number(Q.HR)||0,V=Number(Q.BB)||0,Y=Number(Q.SO)||0,N=Number(Q.SF)||0,z=Number(Q.HBP)||0,j=Number(Q["2B"])||0,E=Number(Q["3B"])||0,C=X-j-E-Z,M=U-Y-Z+N,L=M>0?(X-Z)/M:null,G=J>0?Y/J:null,k=J>0?V/J:null,I=J>0?Z/J:null;return{name:Q.name,player_id:Q.player_id,PA:J,stats:{H:X,HR:Z,BB:V,SO:Y,SF:N,HBP:z,singles:C,doubles:j,triples:E},rates:{kRate:G,bbRate:k,hrRate:I,BABIP:L}}})}function L0(q){return q.map((Q)=>{let J=Number(Q.IP)||0,U=Number(Q.TBF)||0,X=Number(Q.H)||0,Z=Number(Q.HR)||0,V=Number(Q.BB)||0,Y=Number(Q.SO)||0,N=Number(Q.HBP)||0,z=U>0?Y/U:null,j=U>0?V/U:null,E=U>0?Z/U:null,C=U-Y-Z-V-N,M=C>0?(X-Z)/C:null;return{name:Q.name,player_id:Q.player_id,TBF:U,stats:{IP:J,H:X,HR:Z,BB:V,SO:Y,HBP:N},rates:{kRate:z,bbRate:j,hrRate:E,BABIP:M}}})}function n(q,Q,J,U){let X=q.map((Y)=>{let N=J.find((z)=>z.player_id===Y);if(!N)throw new Error(`Lineup player not found: ${Y}`);return N}),Z=U.find((Y)=>Y.player_id===Q);if(!Z)throw new Error(`Starting pitcher not found: ${Q}`);let V=new Set;for(let Y of X){if(V.has(Y.player_id))throw new Error(`Duplicate player in lineup: ${Y.player_id}`);V.add(Y.player_id)}if(V.has(Q))throw new Error(`Pitcher also appears in lineup: ${Q}`);return{lineup:X,pitcher:Z}}function t(q,Q){return(q+Q)/2}function v0(q,Q){let J=q.rates||{},U=Q.rates||{},X=q.stats||{},Z=O(J.kRate??0,"batter.kRate"),V=O(U.kRate??0,"pitcher.kRate"),Y=O(J.bbRate??0,"batter.bbRate"),N=O(U.bbRate??0,"pitcher.bbRate"),z=O(J.hrRate??0,"batter.hrRate"),j=O(U.hrRate??0,"pitcher.hrRate"),E=O(J.BABIP??0.29,"batter.BABIP"),C=O(U.BABIP??0.29,"pitcher.BABIP"),M=Math.max(0,q.PA||0),L=Math.max(0,X.HBP??0),G=Math.max(0,X.singles??0),k=Math.max(0,X.doubles??0),I=Math.max(0,X.triples??0),F=O(t(Z,V),"K"),x=O(t(Y,N),"BB"),p=O(t(z,j),"HR"),z0=O(t(E,C),"BABIP"),a=O(M>0?L/M:0,"HBP"),D=F+x+a+p,W=Math.max(0,1-D),T=z0*W,A=W-T,P=G+k+I,R=P>0?G/P:0.7,N0=P>0?k/P:0.2,p0=P>0?I/P:0.1;return{K:O(F,"K"),BB:O(x,"BB"),HBP:O(a,"HBP"),HR:O(p,"HR"),"1B":O(T*R,"1B"),"2B":O(T*N0,"2B"),"3B":O(T*p0,"3B"),Out:O(A,"Out")}}function O(q,Q){if(typeof q!=="number"||isNaN(q))return 0;if(q<0){if(Q)console.warn(`[probabilityModel] Clamped negative value for ${Q}: ${q} → 0`);return 0}if(q>1){if(Q)console.warn(`[probabilityModel] Clamped value >1 for ${Q}: ${q} → 1`);return 1}return q}function i(q){let{lineup:Q,pitcher:J}=q;return Q.map((U)=>{let X=v0(U,J);return{batter_id:U.player_id,pitcher_id:J.player_id,probabilities:X}})}function o(q){let Q=Object.values(q).reduce((U,X)=>U+X,0),J=Math.random()*Q;for(let[U,X]of Object.entries(q))if((J-=X)<=0)return U;return Object.keys(q).pop()||""}var n0={Groundout:0.48,Flyout:0.32,Lineout:0.12,Popout:0.08},i0={Groundout:{"1B":0.1,"2B":0.27,SS:0.32,"3B":0.16,P:0.15},Flyout:{LF:0.28,CF:0.48,RF:0.24},Lineout:{"1B":0.28,"2B":0.18,SS:0.18,"3B":0.28,LF:0.04,CF:0.02,RF:0.02},Popout:{C:0.3,"1B":0.18,"2B":0.08,SS:0.18,"3B":0.18,LF:0.04,RF:0.04}};function H0(q){if(q==="Out"){let Q=o(n0),J=o(i0[Q]);return`${Q} to ${J}`}return q}function I0(){return{inning:1,top:!0,outs:0,bases:[0,0,0],lineupIndices:[0,0],score:[0,0],pitcherFatigue:[{battersFaced:0},{battersFaced:0}]}}function W0(q){let Q=[];if(q[0])Q.push(0);if(q[1]&&q[0])Q.push(1);if(q[2]&&q[1]&&q[0])Q.push(2);return Q}function E0(q,Q){let J=0,U=[0,0,0];for(let Z=2;Z>=0;Z--){if(!q[Z])continue;let V=Z+(Q==="1B"?1:Q==="2B"?2:Q==="3B"?3:4);if(V>=3)J++;else U[V]=1}let X={"1B":0,"2B":1,"3B":2}[Q];if(X!==void 0)U[X]=1;if(Q==="HR")J++;return[U,J]}function x0(q,Q,J,U,X,Z,V){let Y=Z||o,N=V||H0,z=J.top?0:1,j=z===0?q:Q,E=z===0?X:U,C=Array.isArray(E)?E:[],M=J.lineupIndices[z],L=j[M%j.length],G=L.probabilities;if(J.pitcherFatigue&&J.pitcherFatigue[1-z]){J.pitcherFatigue[1-z].battersFaced++;let D=J.pitcherFatigue[1-z].battersFaced;if(D>18){let T=Math.min((D-18)*0.005,0.05);G={...G};let A=G.Out;if(G.BB)G.BB+=T;if(G["1B"])G["1B"]+=T;if(G.Out){if(G.Out-=T,G.Out<0.5*A)G.Out=0.5*A}let P=Object.values(G).reduce((R,N0)=>R+N0,0);Object.keys(G).forEach((R)=>G[R]=Math.max(0,G[R]/P))}}let k=Y(G),I=N(k);J.lineupIndices[z]++;let F=void 0,x="",p=!1,z0=!1,a=!1;if(k==="Out"){let D=I.match(/to ([A-Z0-9]+)/);if(D){if(x=D[1],F=C.find((W)=>W.position===x),F&&F.stats){let W=Number(F.stats.E)||0,T=Number(F.stats.PO)||0,A=Number(F.stats.A)||0,P=T+A+W,R=P>0?W/P:0.01;if(Math.random()<R)p=!0}else if(Math.random()<0.01)p=!0}}if(p){let[D,W]=E0(J.bases,"1B");return J.bases=D,J.score[z]+=W,{batter_id:L.batter_id,outcome:`Error on ${x}`,fielder:F,fielderPosition:x}}if(k==="Out"&&/^Groundout to [A-Z0-9]+$/.test(I)&&J.outs===0){let D=W0(J.bases);if(D.length>=2){if(Math.random()<0.01){a=!0;let W=D.slice().sort((T,A)=>A-T);for(let T=0;T<2&&T<W.length;T++)J.bases[W[T]]=0;return J.outs=3,{batter_id:L.batter_id,outcome:"Grounded into triple play",...F?{fielder:F,fielderPosition:x}:{}}}}}if(k==="Out"&&/^Groundout to [A-Z0-9]+$/.test(I)&&J.outs<2){let D=W0(J.bases);if(D.length>=1){if(Math.random()<0.25){z0=!0;let W=Math.max(...D);return J.bases[W]=0,J.outs=Math.min(J.outs+2,3),{batter_id:L.batter_id,outcome:"Grounded into double play",...F?{fielder:F,fielderPosition:x}:{}}}}}if(k==="Out"&&/^Groundout to [A-Z0-9]+$/.test(I)){J.outs++;let D=W0(J.bases);for(let W of D.slice().sort((T,A)=>A-T))if(J.bases[W])if(W===2)J.bases[W]=0,J.score[z]+=1;else J.bases[W+1]=1,J.bases[W]=0,console.log("Advancing forced runner from",W,"to",W+1,"Bases:",J.bases);return{batter_id:L.batter_id,outcome:I,...F?{fielder:F,fielderPosition:x}:{}}}if(k==="Out"||k==="K")J.outs++;else if(k==="BB"||k==="HBP"){let[D,W]=E0(J.bases,"1B");J.bases=D,J.score[z]+=W}else{let[D,W]=E0(J.bases,k);J.bases=D,J.score[z]+=W}return{batter_id:L.batter_id,outcome:I,...F?{fielder:F,fielderPosition:x}:{}}}function e(q,Q,J,U,X,Z,V){let Y=V||Math.random;if(!Q.bases[Z-1])return{success:!1,out:!1,description:`No runner on base ${Z} to steal from.`};let N=q===2?0.6:q===3?0.3:0.1;if(J?.stats&&X?.stats){let j=Number(J.stats.SPD||J.stats.SB||50),E=Number(X.stats.ARM||X.stats["CS%"]||50);if(N=0.5+(j-E)/200,q===3)N-=0.2;if(q===4)N-=0.4;N=Math.max(0.05,Math.min(0.95,N))}if(Y(1)<N){if(Q.bases[Z-1]=0,q<=3)Q.bases[q-1]=1;else Q.score[Q.top?0:1]+=1;return{success:!0,out:!1,description:`Runner successfully stole base ${q===4?"Home":q}`}}else return Q.bases[Z-1]=0,Q.outs++,{success:!1,out:!0,description:`Runner caught stealing base ${q===4?"Home":q}`}}function q0(q,Q,J,U,X,Z){let V=Z||Math.random;if(!Q.bases[q-1])return{success:!1,out:!1,error:!1,description:`No runner on base ${q} to pick off.`};let Y=0.05,N=0.1;if(U?.stats&&J?.stats){let j=Number(U.stats.PK||50),E=Number(J.stats.SPD||50);Y=0.03+(j-E)/1000,Y=Math.max(0.01,Math.min(0.15,Y))}if(X?.stats)N=0.05+Number(X.stats.E||0)/1000,N=Math.max(0.01,Math.min(0.2,N));let z=V(1);if(z<Y)return Q.bases[q-1]=0,Q.outs++,{success:!0,out:!0,error:!1,description:`Runner picked off at base ${q}`};else if(z<Y+N){if(Q.bases[q-1]=0,q<3)Q.bases[q]=1;else Q.score[Q.top?0:1]+=1;return{success:!1,out:!1,error:!0,description:`Pickoff error: runner advances from base ${q}`}}else return{success:!1,out:!1,error:!1,description:`Pickoff attempt at base ${q} unsuccessful`}}function P0(q,Q){if(!q)return!1;let{inning:J,top:U,score:X,runsScoredThisHalf:Z}=q,[V,Y]=X;if(!U&&J>=9&&Z>0&&Y>V)return Q("Home",X,J,!1),!0;return!1}function G0(q,Q){if(!q||!q.isHalfInningOver)return;let{inning:J,top:U,score:X}=q,[Z,V]=X;if(J<9)return;if(J===9&&U)return;if(J>9&&U){if(V>Z){Q("Home",X,J,!0);return}if(Z>V){Q("Away",X,J,!0);return}return}}var f=document.getElementById("home-team-select"),h=document.getElementById("away-team-select"),A0=document.getElementById("load-teams-btn"),S=document.getElementById("status"),D0=document.getElementById("lineups-container"),J0=document.getElementById("game-state-container"),w=document.getElementById("next-atbat-btn"),B=document.getElementById("atbat-result-container"),y0=document.getElementById("customize-home-lineup-btn"),w0=document.getElementById("customize-away-lineup-btn"),l=document.getElementById("custom-lineup-modal"),S0=document.getElementById("close-lineup-modal"),B0=document.getElementById("lineup-modal-title"),g0=document.getElementById("custom-lineup-form"),r=document.getElementById("batting-order-list"),s=document.getElementById("pitcher-select"),y=document.getElementById("lineup-error"),Q0=document.getElementById("steal-2b-btn"),U0=document.getElementById("steal-3b-btn"),X0=document.getElementById("steal-home-btn"),Y0=document.getElementById("pickoff-1b-btn"),Z0=document.getElementById("pickoff-2b-btn"),$0=document.getElementById("pickoff-3b-btn"),v=null,H=null,K=null,_=null,c=null,m=null,$=null,o0=1,r0=!0,b=null,V0=null,d=null,K0=null,f0=null,_0=[];async function s0(){return["ARI-2025.html","ATL-2025.html","BAL-2025.html","BOS-2025.html","CHC-2025.html","CHW-2025.html","CIN-2025.html","CLE-2025.html","COL-2025.html","DET-2025.html","HOU-2025.html","KCR-2025.html","LAA-2025.html","LAD-2025.html","MIA-2025.html","MIL-2025.html","MIN-2025.html","NYM-2025.html","NYY-2025.html","OAK-2025.html","PHI-2025.html","PIT-2025.html","SDP-2025.html","SEA-2025.html","SFG-2025.html","STL-2025.html","TBR-2025.html","TEX-2025.html","TOR-2025.html","WSN-2025.html"]}async function R0(q){let J=await(await fetch(`./data/${q}`)).text(),{batting:U,pitching:X}=T0(J),Z=U?j0(U):[],V=X?j0(X):[],Y=k0(Z),N=L0(V);return{batters:Y,pitchers:N}}function h0(q,Q){if(!D0)return;D0.innerHTML="";let J=(U,X)=>{if(!U)return`<div><strong>${X}:</strong> Not loaded</div>`;let Z=U.lineup||U.batters||[],V=U.pitcher||U.pitchers&&U.pitchers[0]||{name:"N/A"};return`
      <div style="margin-bottom:1.5em;">
        <strong>${X} Lineup</strong>
        <table class="lineup-table">
          <thead><tr><th>#</th><th>Name</th><th>PA</th></tr></thead>
          <tbody>
            ${(Z||[]).slice(0,9).map((Y,N)=>`<tr><td>${N+1}</td><td>${Y.name||""}</td><td>${Y.PA||""}</td></tr>`).join("")}
          </tbody>
        </table>
        <div><strong>Pitcher:</strong> ${V.name}</div>
      </div>
    `};D0.innerHTML=`
    <div style="display:flex;gap:2em;flex-wrap:wrap;">
      <div style="flex:1;min-width:250px;">${J(q,"Home")}</div>
      <div style="flex:1;min-width:250px;">${J(Q,"Away")}</div>
    </div>
  `}function b0(){if(!J0)return;if(!$||!K||!_){if(J0.innerHTML="<em>Game not started.</em>",w)w.style.display="none";return}let q=$,{inning:Q,top:J,outs:U,bases:X,score:Z,lineupIndices:V}=q,Y=J?0:1,N=Y===0?m:c,z=Y===0?_:K;if(!z){if(J0.innerHTML="<em>Roster not loaded.</em>",w)w.style.display="none";return}let j=V[Y]%z.lineup.length,E=z.lineup[j],C=(Y===0?K:_).pitcher,M=["1B","2B","3B"].map((L,G)=>q.bases[G]?L:"").filter(Boolean).join(", ")||"Empty";if(J0.innerHTML=`
    <div><strong>Inning:</strong> ${Q} (${J?"Top":"Bottom"})</div>
    <div><strong>Outs:</strong> ${U}</div>
    <div><strong>Bases:</strong> ${M}</div>
    <div><strong>Score:</strong> Away ${Z[0]} &ndash; Home ${Z[1]}</div>
    <div style="margin-top:1em;"><strong>At Bat:</strong> ${E.name} (vs ${C.name})</div>
  `,w)w.style.display=""}function u(q,Q=!1){if(!B)return;if(!q)return;_0.push(q),C0()}function C0(){if(!B)return;B.innerHTML="";let q=null,Q=null;for(let J of _0){if(J.inning!==q||J.top!==Q){let Z=document.createElement("div");Z.style.marginTop="1em",Z.style.fontWeight="bold",Z.textContent=`Inning ${J.inning} - ${J.top?"Top":"Bottom"}`,B.appendChild(Z),q=J.inning,Q=J.top}let U=["1B","2B","3B"].map((Z,V)=>J.bases[V]?Z:"").filter(Boolean).join(", ")||"Empty",X=document.createElement("div");X.innerHTML=`<strong>${J.batterName}:</strong> ${J.outcome} <span style="color:#888">(Outs: ${J.outs}, Score: Away ${J.score[0]} – Home ${J.score[1]}, Bases: ${U})</span>`,B.appendChild(X)}}function O0(q,Q,J,U){if(w)w.disabled=!0;if(S)S.textContent=`Game Over: ${q} wins! Final Score: Away ${Q[0]} – Home ${Q[1]} (${J}${U?" Top":" Bottom"})`;if(B){let X=document.createElement("div");X.style.marginTop="1em",X.style.fontWeight="bold",X.style.color="#b00",X.textContent=`Game Over: ${q} wins! Final Score: Away ${Q[0]} – Home ${Q[1]} (${J}${U?" Top":" Bottom"})`,B.appendChild(X)}}function a0(){if(!K||!_)return;c=i(K),m=i(_),$=I0(),_0=[],C0(),g()}function t0(){if(!$||!c||!m)return;let q=$,Q=q.top?0:1,J=Q===0?m:c,U=Q===0?_:K;if(!U)return;let X=q.lineupIndices[Q]%U.lineup.length,Z=U.lineup[X],V=x0(m,c,q,[],[]);u({batterName:Z.name,outcome:V.outcome,outs:q.outs,score:[...q.score],bases:[...q.bases],inning:q.inning,top:q.top});let Y=q;if(!Y._halfInningStartScore)Y._halfInningStartScore=[...q.score];if(P0(Y,O0)){g();return}let N="",z=!1,j=!1,E=!1;if(q.outs>=3){q.outs=0,q.bases=[0,0,0];let C=q.top?q.score[0]-Y._halfInningStartScore[0]:q.score[1]-Y._halfInningStartScore[1];if(q.top)q.top=!1,N="End of top half. Switching to bottom of inning.",z=!0,j=!0;else q.top=!0,q.inning++,N="End of inning. Advancing to next inning.",z=!0,E=!0;Y._halfInningStartScore=[...q.score],Y.isHalfInningOver=!0,Y.runsScoredThisHalf=C}else Y.isHalfInningOver=!1,Y.runsScoredThisHalf=0;if(z){if(B){let C=document.createElement("div");C.innerHTML=`<em>${N}</em>`,B.appendChild(C),o0=q.inning,r0=q.top;let M=document.createElement("div");M.style.marginTop="1em",M.style.fontWeight="bold",M.textContent=`Inning ${q.inning} - ${q.top?"Top":"Bottom"}`,B.appendChild(M)}G0(Y,O0)}else G0(Y,O0);g()}async function M0(){if(!f||!h||!S)return;let q=f.value,Q=h.value;if(!q||!Q)return;S.textContent="Loading lineups...";try{let[J,U]=await Promise.all([R0(q),R0(Q)]);v=J,H=U,K=J&&J.batters&&J.pitchers?n(b&&b.length===9?b:J.batters.slice(0,9).map((X)=>X.player_id),V0||J.pitchers[0].player_id,J.batters,J.pitchers):null,_=U&&U.batters&&U.pitchers?n(d&&d.length===9?d:U.batters.slice(0,9).map((X)=>X.player_id),K0||U.pitchers[0].player_id,U.batters,U.pitchers):null,h0(K,_),_0=[],C0(),S.textContent="Lineups loaded. Ready to simulate!",a0()}catch(J){S.textContent="Failed to load lineups."}}async function d0(){if(!S)return;S.textContent="Loading teams...";let q=await s0();if(!q.length){S.textContent="No teams found in data folder.";return}for(let Q of[f,h]){if(!Q)continue;Q.innerHTML="";for(let J of q){let U=document.createElement("option");U.value=J,U.textContent=J.replace(".html",""),Q.appendChild(U)}}if(f)f.value="CHC-2025.html";if(h)h.value="MIL-2025.html";if(S.textContent="Select home and away teams.",f&&h)M0()}function e0(){if(!v||!H)return;if(K=v&&v.batters&&v.pitchers?n(b&&b.length===9?b:v.batters.slice(0,9).map((q)=>q.player_id),V0||v.pitchers[0].player_id,v.batters,v.pitchers):null,_=H&&H.batters&&H.pitchers?n(d&&d.length===9?d:H.batters.slice(0,9).map((q)=>q.player_id),K0||H.pitchers[0].player_id,H.batters,H.pitchers):null,K&&_)c=i({lineup:K.lineup,pitcher:_.pitcher}),m=i({lineup:_.lineup,pitcher:K.pitcher});h0(K,_),b0()}function u0(q,Q,J,U,X){if(f0=q,!l||!B0||!r||!s)return;if(B0.textContent=`Customize ${q==="home"?"Home":"Away"} Lineup`,y)y.textContent="";l.style.display="flex";let Z=U,V=X;if(q==="home"&&K)Z=K.lineup?K.lineup.map((Y)=>Y.player_id):U,V=K.pitcher?K.pitcher.player_id:X;else if(q==="away"&&_)Z=_.lineup?_.lineup.map((Y)=>Y.player_id):U,V=_.pitcher?_.pitcher.player_id:X;r.innerHTML="";for(let Y=0;Y<9;Y++){let N=document.createElement("li"),z=document.createElement("select");if(z.name=`batter${Y}`,z.required=!0,z.innerHTML='<option value="">-- Select --</option>'+Q.map((j)=>`<option value="${j.player_id}">${j.name} (${j.PA} PA)</option>`).join(""),Z&&Z[Y])z.value=Z[Y];N.appendChild(z),r.appendChild(N)}if(s.innerHTML='<option value="">-- Select --</option>'+J.map((Y)=>`<option value="${Y.player_id}">${Y.name} (${Y.stats&&Y.stats.IP?Y.stats.IP:""} IP)</option>`).join(""),V)s.value=V}function qq(){if(!$)return;if(Q0)Q0.disabled=!$.bases[0];if(U0)U0.disabled=!$.bases[1];if(X0)X0.disabled=!$.bases[2];if(Y0)Y0.disabled=!$.bases[0];if(Z0)Z0.disabled=!$.bases[1];if($0)$0.disabled=!$.bases[2]}function g(){b0(),qq()}if(A0)A0.addEventListener("click",d0);if(f)f.addEventListener("change",M0);if(h)h.addEventListener("change",M0);if(w)w.addEventListener("click",t0);if(y0)y0.addEventListener("click",()=>{if(!v)return;u0("home",v.batters,v.pitchers,b,V0)});if(w0)w0.addEventListener("click",()=>{if(!H)return;u0("away",H.batters,H.pitchers,d,K0)});if(S0)S0.addEventListener("click",()=>{if(l)l.style.display="none"});if(g0)g0.addEventListener("submit",(q)=>{if(q.preventDefault(),!r||!s)return;let Q=[],J=r.querySelectorAll("select");for(let X of J){if(!X.value){if(y)y.textContent="Please select a player for every lineup slot.";return}Q.push(X.value)}if(new Set(Q).size!==Q.length){if(y)y.textContent="No duplicate players allowed in the lineup.";return}let U=s.value;if(!U){if(y)y.textContent="Please select a starting pitcher.";return}if(Q.includes(U)){if(y)y.textContent="Pitcher cannot also be in the batting lineup.";return}if(f0==="home")b=Q,V0=U;else d=Q,K0=U;if(l)l.style.display="none";e0()});window.addEventListener("DOMContentLoaded",()=>{d0()});if(Q0)Q0.addEventListener("click",()=>{if(!$||!K||!_)return;let q=$.top?0:1,J=(q===0?_:K).lineup.find((V)=>!0)||{},U=(q===0?K:_).pitcher,X=(q===0?K:_).lineup[0]||{},Z=e(2,$,J,U,X,1);u({batterName:"Runner",outcome:Z.description,outs:$.outs,score:[...$.score],bases:[...$.bases],inning:$.inning,top:$.top}),g()});if(U0)U0.addEventListener("click",()=>{if(!$||!K||!_)return;let q=$.top?0:1,J=(q===0?_:K).lineup.find((V)=>!0)||{},U=(q===0?K:_).pitcher,X=(q===0?K:_).lineup[0]||{},Z=e(3,$,J,U,X,2);u({batterName:"Runner",outcome:Z.description,outs:$.outs,score:[...$.score],bases:[...$.bases],inning:$.inning,top:$.top}),g()});if(X0)X0.addEventListener("click",()=>{if(!$||!K||!_)return;let q=$.top?0:1,J=(q===0?_:K).lineup.find((V)=>!0)||{},U=(q===0?K:_).pitcher,X=(q===0?K:_).lineup[0]||{},Z=e(4,$,J,U,X,3);u({batterName:"Runner",outcome:Z.description,outs:$.outs,score:[...$.score],bases:[...$.bases],inning:$.inning,top:$.top}),g()});if(Y0)Y0.addEventListener("click",()=>{if(!$||!K||!_)return;let q=$.top?0:1,J=(q===0?_:K).lineup.find((V)=>!0)||{},U=(q===0?K:_).pitcher,X=(q===0?K:_).lineup[0]||{},Z=q0(1,$,J,U,X);u({batterName:"Runner",outcome:Z.description,outs:$.outs,score:[...$.score],bases:[...$.bases],inning:$.inning,top:$.top}),g()});if(Z0)Z0.addEventListener("click",()=>{if(!$||!K||!_)return;let q=$.top?0:1,J=(q===0?_:K).lineup.find((V)=>!0)||{},U=(q===0?K:_).pitcher,X=(q===0?K:_).lineup[0]||{},Z=q0(2,$,J,U,X);u({batterName:"Runner",outcome:Z.description,outs:$.outs,score:[...$.score],bases:[...$.bases],inning:$.inning,top:$.top}),g()});if($0)$0.addEventListener("click",()=>{if(!$||!K||!_)return;let q=$.top?0:1,J=(q===0?_:K).lineup.find((V)=>!0)||{},U=(q===0?K:_).pitcher,X=(q===0?K:_).lineup[0]||{},Z=q0(3,$,J,U,X);u({batterName:"Runner",outcome:Z.description,outs:$.outs,score:[...$.score],bases:[...$.bases],inning:$.inning,top:$.top}),g()});
